; Form Designer for Purebasic - 6.11
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the FormDesigner.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures needs to be put in another source file.
;

Global MainWindow

Global Image_ComputerIcon, Text_Introduction, Text_Computer, Text_ComputerName, Button_ExportAsFile, Text_User, Text_UserName, Frame_Method, Image_CSV, Image_Error, Hyperlink_ExportFolder, Text_Serial, Hyperlink_SerialNumber, Button_ImportIntune, Image_Intune

Global Img_MainWindow_0, Img_MainWindow_1, Img_MainWindow_2, Img_MainWindow_3

UsePNGImageDecoder()

Img_MainWindow_0 = CatchImage(#PB_Any,?Img_MainWindow_0)
Img_MainWindow_1 = CatchImage(#PB_Any,?Img_MainWindow_1)
Img_MainWindow_2 = CatchImage(#PB_Any,?Img_MainWindow_2)
Img_MainWindow_3 = CatchImage(#PB_Any,?Img_MainWindow_3)

Enumeration FormFont
  #Font_MainWindow_0
  #Font_MainWindow_1
EndEnumeration

LoadFont(#Font_MainWindow_0,"Segoe UI", 9, #PB_Font_Bold)
LoadFont(#Font_MainWindow_1,"Consolas", 9)

Declare Import_HashID_Intune(EventType)
Declare Export_HashID_CSV(EventType)
Declare Clipboard_SerialNumber(EventType)
Declare Open_HashID_ExportFolder(EventType)

Procedure OpenMainWindow(x = 0, y = 0, width = 530, height = 410)
  MainWindow = OpenWindow(#PB_Any, x, y, width, height, "Windows Autopilot Import Tool for Intune - TUGI", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered)
  Image_ComputerIcon = ImageGadget(#PB_Any, 20, 20, 128, 128, ImageID(Img_MainWindow_0))
  Text_Introduction = TextGadget(#PB_Any, 170, 30, 340, 40, "This tool helps you easily and quickly import the running Windows into Microsoft Intune to use Windows Autopilot.")
  Text_Computer = TextGadget(#PB_Any, 170, 80, 70, 20, "Computer:")
  SetGadgetFont(Text_Computer, FontID(#Font_MainWindow_0))
  Text_ComputerName = TextGadget(#PB_Any, 250, 80, 240, 20, "-")
  SetGadgetFont(Text_ComputerName, FontID(#Font_MainWindow_1))
  Button_ExportAsFile = ButtonGadget(#PB_Any, 40, 300, 210, 30, "Export Hash ID as file")
  Text_User = TextGadget(#PB_Any, 170, 100, 70, 20, "User")
  SetGadgetFont(Text_User, FontID(#Font_MainWindow_0))
  Text_UserName = TextGadget(#PB_Any, 250, 100, 240, 20, "-")
  Frame_Method = FrameGadget(#PB_Any, 20, 190, 490, 160, "Method")
  Image_CSV = ImageGadget(#PB_Any, 120, 230, 48, 48, ImageID(Img_MainWindow_1))
  Image_Error = ImageGadget(#PB_Any, 60, 50, 48, 48, ImageID(Img_MainWindow_2))
  Hyperlink_ExportFolder = HyperLinkGadget(#PB_Any, 20, 370, 490, 25, "CSV successfully exported - open export folder here", 0)
  SetGadgetColor(Hyperlink_ExportFolder, #PB_Gadget_FrontColor,RGB(0,128,255))
  Text_Serial = TextGadget(#PB_Any, 170, 120, 70, 25, "Serial")
  SetGadgetFont(Text_Serial, FontID(#Font_MainWindow_0))
  Hyperlink_SerialNumber = HyperLinkGadget(#PB_Any, 250, 120, 240, 25, "-", 0)
  GadgetToolTip(Hyperlink_SerialNumber, "Copy serial number to clipboard.")
  Button_ImportIntune = ButtonGadget(#PB_Any, 280, 300, 210, 30, "Import to Intune")
  Image_Intune = ImageGadget(#PB_Any, 360, 230, 48, 48, ImageID(Img_MainWindow_3))
EndProcedure

Procedure MainWindow_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case Button_ExportAsFile
          Export_HashID_CSV(EventType())          
        Case Hyperlink_ExportFolder
          Open_HashID_ExportFolder(EventType())          
        Case Hyperlink_SerialNumber
          Clipboard_SerialNumber(EventType())          
        Case Button_ImportIntune
          Import_HashID_Intune(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure



DataSection
  Img_MainWindow_0: : IncludeBinary "..\Ressources\Icon_Computer.png"
  Img_MainWindow_1: : IncludeBinary "..\Ressources\Icon_CSV.png"
  Img_MainWindow_2: : IncludeBinary "..\Ressources\Icon_Error.png"
  Img_MainWindow_3: : IncludeBinary "..\Ressources\Icon_Import.png"
EndDataSection
